<html>
    <body onload="pullData()">
        <div class="tabContainer">
            <div id="tab1">
                <h3 id="Sh">Small Hut</h3>
                <button id="stokebtn">Stoke Fire</button>
                <h4 id="firetext">Fire Health: -</h3>
            </div>
            <div id="tab2">
                <h3 id="Df">Dark Forest</h3>
                <button id="woodbtn">Collect Wood</button>
                <h3 id="woodtext">You have - wood.</h3>
            </div>
            <div id="tab3">
                <h3 id="Bs">Building Station</h3>
                <h4 id="populationtext">Population: -</h4>
                    <h4 id="maxpopulationtext">Max Population: -</h4>
                    <h4 id="huttext">Huts: -</h4>
                    <button id="hutbtn">Build Hut (50 Wood)</button>
                    <h4 id="lbgtext">Lumberjacks: (-)</h4>
                    <button id="lbghirebtn">Hire</button>
                    <button id="lbgfirebtn">Fire</button>
                    <h4 id="skrtext">Stokers: (-)</h4>
                    <button id="skrhirebtn">Hire</button>
                    <button id="skrfirebtn">Fire</button>
                    <h1>Data</h1>
                    <button onclick="saveData()">Save Data</button>
                    <button onclick="resetData()">Reset Data</button>
            </div>
        </div>

        <button id="tabButton1" class="tabButton">Small Hut (-)</button>
        <button id="tabButton2" class="tabButton">Dark Forest</button>
        <button id="tabButton3" class="tabButton">Building Station</button>

        <script>
            var lbgsave = localStorage.getItem("lbgsave")
            var skrsave = localStorage.getItem("skrsave")
            var popsave = localStorage.getItem("popsave")
            var maxpopsave = localStorage.getItem("maxpopsave")
            var firehealthsave = localStorage.getItem("firehealthsave")
            var woodsave = localStorage.getItem("woodsave")
            var hutsave = localStorage.getItem("hutsave")
            // Reset Data
            function resetData() {
                lumberjacks = 0
                stokers = 0
                population = 0
                maxpopulation = 0
                firehealth = 0
                wood = 0
                huts = 0
                saveData()
            }
            // Save Data
            function saveData() {
                localStorage.setItem("lbgsave", toString(lumberjacks))
                localStorage.setItem("skrsave", toString(stokers))
                localStorage.setItem("popsave", toString(population))
                localStorage.setItem("maxpopsave", toString(maxpopulation))
                localStorage.setItem("firehealthsave", toString(firehealth))
                localStorage.setItem("woodsave", toString(wood))
                localStorage.setItem("hutsave", toString(huts))
            }
            // Load Data
            function pullData() {
                localStorage.getItem("lbgsave")
                localStorage.getItem("skrsave")
                localStorage.getItem("popsave")
                localStorage.getItem("maxpopsave")
                localStorage.getItem("firehealthsave")
                localStorage.getItem("woodsave")
                localStorage.getItem("hutsave")
                lumberjacks = Number(lbgsave.valueOf())
                stokers = Number(skrsave.valueOf())
                population = Number(popsave.valueOf())
                maxpopulation = Number(maxpopsave.valueOf())
                firehealth = Number(firehealthsave.valueOf())
                wood = Number(woodsave.valueOf())
                huts = Number(hutsave.valueOf())
                document.getElementById("lbgtext").innerHTML = "Lumberjacks: (" + lumberjacks + ")"
                document.getElementById("skrtext").innerHTML = "Stokers: (" + stokers + ")"
                document.getElementById("populationtext").innerHTML = "Population: " + population
                document.getElementById("maxpopulationtext").innerHTML = "Max Population: " + maxpopulation
                document.getElementById("firetext").innerHTML = "Fire Health: " + firehealth
                document.getElementById("tabButton1").innerHTML = "Small Hut (" + firehealth + ")"
                document.getElementById("woodtext").innerHTML = "You have " + wood + " wood."
                document.getElementById("huttext").innerHTML = "Huts: " + huts
            }
            setInterval(300000, saveData)
        </script>

        <script>
            function lbgWps() {
                wood += 4 * lumberjacks
                woodtext.innerHTML = "You have " + wood + " wood."
            }
            function skrHps() {
                if (firehealth <= 85 && wood >= 2) {
                    firehealth += 15 * stokers
                    if (firehealth > 100) {
                        firehealth = 100
                    }
                    wood -= 2 * stokers
                    woodtext.innerHTML = "You have " + wood + " wood."
                    firetext.innerHTML = "Fire Health: " + firehealth
                    document.getElementById("tabButton1").innerHTML = "Small Hut (" + firehealth + ")"
                }
            }
            setInterval(lbgWps, 1000)
            setInterval(skrHps, 1000)
            var lumberjacks = 0
            var stokers = 0
            document.getElementById("lbghirebtn").addEventListener("click", function() {
                if ((population + lumberjacks + stokers) <= maxpopulation) {
                    if (population > 0) {
                        lumberjacks += 1
                        population -= 1
                        document.getElementById("lbgtext").innerHTML = "Lumberjacks: (" + lumberjacks + ")"
                        document.getElementById("populationtext").innerHTML = "Population: " + population
                    }
                }
            })
            document.getElementById("lbgfirebtn").addEventListener("click", function() {
                if (lumberjacks > 0) {
                    lumberjacks -= 1
                    population += 1
                    document.getElementById("lbgtext").innerHTML = "Lumberjacks: (" + lumberjacks + ")"
                    document.getElementById("populationtext").innerHTML = "Population: " + population
                }
            })
            document.getElementById("skrhirebtn").addEventListener("click", function() {
                if ((population + lumberjacks + stokers) < maxpopulation) {
                    if (population > 0) {
                        stokers += 1
                        population -= 1
                        document.getElementById("skrtext").innerHTML = "Stokers: (" + stokers + ")"
                        document.getElementById("populationtext").innerHTML = "Population: " + population
                    }
                }
            })
            document.getElementById("skrfirebtn").addEventListener("click", function() {
                if (stokers > 0) {
                    stokers -= 1
                    population += 1
                    document.getElementById("skrtext").innerHTML = "Stokers: (" + stokers + ")"
                    document.getElementById("populationtext").innerHTML = "Population: " + population
                }
            })
            // Fire
            var firehealth = 100
                    firetext = document.getElementById("firetext")
                    stokebtn = document.getElementById("stokebtn")
        
                    firetext.style.textAlign = 'center'
                    firetext.innerHTML = "Fire Health: " + firehealth
                    document.getElementById("tabButton1").innerHTML = "Small Hut (" + firehealth + ")"
        
                    stokebtn.addEventListener("click", function() {
                        onClick("fire")
                    })
        
                    function drainFireHealth() {
                        firehealth -= 5
                        firetext.innerHTML = "Fire Health: " + firehealth
                        document.getElementById("tabButton1").innerHTML = "Small Hut (" + firehealth + ")"
                        if (firehealth <= 0) {
                            document.body.style.backgroundColor = "red"
                            sleep(500).then(() => {
                                if (confirm("You Died.\nRestarting.")) {
                                    location.reload()
                                } else {
                                    location.reload()
                                }
                            })
                        }
                    }
            // Wood
            var wood = 0
              woodtext = document.getElementById("woodtext")
              woodbtn = document.getElementById("woodbtn")
  
              woodtext.innerHTML = "You have " + wood + " wood."
              woodtext.style.textAlign = 'center'
  
              woodbtn.addEventListener("click", function() {
                  onClick("wood")
              })
            // Building Station
            var population = 0
                      var maxpopulation = 0
                      var huts = 0
                      populationtext = document.getElementById("populationtext")
                      maxpopulationtext = document.getElementById("maxpopulationtext")
                      huttext = document.getElementById("huttext")
                      hutbtn = document.getElementById("hutbtn")
            
                      populationtext.innerHTML = "Population: " + population
                      maxpopulationtext.innerHTML = "Max Population: " + maxpopulation
                      huttext.innerHTML = "Huts: " + huts
            
                      hutbtn.addEventListener("click", function() {
                        onClick("hut")
                      })
            // Button Clicks
            function onClick(btn) {
                if (btn == "wood") {
                    wood += 4
                    woodtext.innerHTML = "You have " + wood + " wood."
                    woodbtn.disabled = true
                    sleep(3000).then(() => { woodbtn.disabled = false })
                } else if (btn == "fire" && wood >= 2 && firehealth < 100) {
                    firehealth += 15
                    wood -= 2
                    if (firehealth > 100) {
                        firehealth = 100
                    }
                    document.getElementById("tabButton1").innerHTML = "Small Hut (" + firehealth + ")"
                    woodtext.innerHTML = "You have " + wood + " wood."
                    firetext.innerHTML = "Fire Health: " + firehealth
                    stokebtn.disabled = true
                    sleep(1500).then(() => { stokebtn.disabled = false })
                } else if (btn == "hut" && wood >= 50) {
                  wood -= 50
                  maxpopulation += 5
                  huts += 1
                  woodtext.innerHTML = "You have " + wood + " wood."
                  populationtext.innerHTML = "Population: " + population
                  maxpopulationtext.innerHTML = "Max Population: " + maxpopulation
                  huttext.innerHTML = "Huts: " + huts
                  hutbtn.disabled = true
                  sleep(15000).then(() => {hutbtn.disabled = false })
                }
            }
            function sleep(ms) {
                return new Promise(resolve => setTimeout(resolve, ms))
            }
            // Population
            function addpopulation() {
            if ((population + lumberjacks + stokers) < maxpopulation) {
                population += 1
                populationtext.innerHTML = "Population: " + population
              } else if ((population + lumberjacks + stokers) >= maxpopulation){
                population = maxpopulation
                populationtext.innerHTML = "Population: " + population
              }
            }
  </script>

        <script>
            setInterval(addpopulation, 30000)
            setInterval(drainFireHealth, 3500)
            // Holds a "document.getElementById()" for each tab
            const tabs = [ document.getElementById("tab1"), document.getElementById("tab2"), document.getElementById("tab3") ]
            // Holds a "document.getElementById()" for each tab button
            const tabButtons = [ document.getElementById("tabButton1"), document.getElementById("tabButton2"), document.getElementById("tabButton3") ]
            updateContent()
            // Add the listeners for each button
            tabButtons.forEach(addListeners)
            function addListeners(currentValue, index) {
                currentValue.className = "tabButton"
                currentValue.addEventListener("click", function() {
                    currentValue.className = "tabButtonON"
                    tabButtons.forEach(element => {
                        if (element != currentValue) {
                            element.className = "tabButton"
                        }
                    });
                    updateContent()
                })
            }
            // Update the content to display the current tab's content instead of nothing
            function updateContent() {
                tabButtons.forEach(element => {
                    if (element.className == "tabButtonON") {
                        tabs[tabButtons.indexOf(element)].hidden = false
                    } else {
                        tabs[tabButtons.indexOf(element)].hidden = true
                    }
                });
            }
        </script>
        <link rel="stylesheet" href="styles.css">
    </body>
</html>